import numpy as np

# Mapping dari rule
AKSARA_WIANJANA = list(range(0, 18))

CLASS_MAPPING = {
    0: 'ha', 1: 'na', 2: 'ca', 3: 'ra', 4: 'ka', 5: 'da', 6: 'ta', 7: 'sa',
    8: 'wa', 9: 'la', 10: 'ma', 11: 'ga', 12: 'ba', 13: 'nga', 14: 'pa',
    15: 'ja', 16: 'ya', 17: 'nya',
    18: 'gantungan_ha', 19: 'gantungan_na', 20: 'gantungan_ca',
    21: 'gantungan_ra', 22: 'gantungan_da', 23: 'gantungan_ta',
    24: 'gantungan_sa', 25: 'gantungan_wa', 26: 'gantungan_la',
    27: 'gantungan_ma', 28: 'gantungan_ga', 29: 'gantungan_ba',
    30: 'gantungan_nga', 31: 'gantungan_pa', 32: 'gantungan_ja',
    33: 'gantungan_ya', 34: 'gantungan_nya',
    35: 'tedong', 36: 'ulu', 37: 'suku', 38: 'taleng', 39: 'pepet',
    40: 'cecek', 41: 'surang', 42: 'bisah', 43: 'adeg-adeg',
    44: 'titik', 45: 'a_kara', 46: 'i_kara', 47: 'u_kara',
    48: 'sa_saga', 49: 'na_rambat', 50: 'da_madu', 51: 'la_lengan',
    52: 'gantungan_da_madu', 53: 'gantungan_ra_repa', 54: 'gantungan_ta_tawa'
}


class MajorLineBalineseSorter:

    def __init__(self, debug=False):
        self.debug = debug

    def is_wianjana(self, class_id):
        return class_id in AKSARA_WIANJANA

    def cluster_by_y(self, detections):
        if self.debug:
            print("DEBUG sample detection:", detections[0])

        if len(detections) < 2:
            return [detections]

        for d in detections:
            ymin = d['position'][1]
            ymax = d['position'][3]
            d['cy'] = (ymin + ymax) / 2
            d['h'] = (ymax - ymin)

        # Buat list line kosong
        lines = []

        for det in detections:
            cy = det['cy']
            h = det['h']
            top = cy - h * 0.1
            bottom = cy + h * 0.1

            placed = False

            for line in lines:
                # cek overlap dengan line existing
                line_tops = [d2['cy'] - d2['h'] * 0.1 for d2 in line]
                line_bots = [d2['cy'] + d2['h'] * 0.1 for d2 in line]

                if not (bottom < min(line_tops) or top > max(line_bots)):
                    # ada overlap masuk cluster
                    line.append(det)
                    placed = True
                    break

            if not placed:
                lines.append([det])

        # sort by Y
        lines = sorted(lines, key=lambda L: np.mean([d['cy'] for d in L]))

        if self.debug:
            print(f"Found {len(lines)} horizontal lines (height-based)")

        return lines

    def is_major_line(self, chars):
        # Check apakah line adalah MAJOR (wianjana >= 60%)
        total = len(chars)
        wianjana_count = sum(1 for c in chars if self.is_wianjana(c['class_id']))

        wianjana_ratio = wianjana_count / total if total > 0 else 0

        is_major = (wianjana_ratio >= 0.3 and wianjana_count >=3)

        if self.debug:
            status = "MAJOR" if is_major else "SUPPORTING"
            print(f"  Line: {status:15s} | Wianjana: {wianjana_count}/{total} ({wianjana_ratio:.1%})")

        return is_major

    def filter_major_lines(self, lines):
        major_lines = []

        for line in lines:
            if self.is_major_line(line):
                major_lines.append(line)

        if self.debug:
            print(
                f"\nFiltered: {len(major_lines)} MAJOR lines (discarded {len(lines) - len(major_lines)} supporting lines)")

        return major_lines

    def sort_line(self, chars):
        """Sort characters dalam 1 line: kiri ke kanan"""
        return sorted(chars, key=lambda c: c['position'][0])

    def sort_detections(self, detections):
        """Main sorting function"""
        if not detections:
            return []

        if self.debug:
            print("=" * 60)
            print("MAJOR LINE BALINESE SORTING")
            print("=" * 60)
            print(f"Total detections: {len(detections)}\n")

        # Step 1: Cluster by Y position
        lines = self.cluster_by_y(detections)

        if self.debug:
            print(f"Step 1: Clustered into {len(lines)} lines\n")
            print("Step 2: Classifying lines...")

        # Step 2: Filter hanya MAJOR lines
        major_lines = self.filter_major_lines(lines)

        if not major_lines:
            if self.debug:
                print("\n⚠ No MAJOR lines found!")
            return []

        # Step 3: Sort each MAJOR line (kiri ke kanan)
        if self.debug:
            print(f"\nStep 3: Sorting characters in each MAJOR line...")

        # result = []
        # for i, line in enumerate(major_lines):
        #     sorted_line = self.sort_line(line)
        #     result.extend(sorted_line)

        final = []
        for i, line in enumerate(major_lines):
            sorted_line = self.sort_line(line)
            only_wianjana = [c for c in sorted_line if self.is_wianjana(c['class_id'])]
            final.extend(only_wianjana)

            if self.debug:
                print(f"  MAJOR line {i + 1}: {len(sorted_line)} characters")

        if self.debug:
            print(f"\n✓ Final result: {len(final)} characters from {len(major_lines)} MAJOR lines")
            print("=" * 60)


        # Return hanya wianjana
        # result = [c for c in result if self.is_wianjana(c['class_id'])]

        # return major lines
        major_lines = self.filter_major_lines(lines)

        return final, major_lines


def major_lines_aksara(detections, debug=False):
    sorter = MajorLineBalineseSorter(debug=debug)
    return sorter.sort_detections(detections)

#     Makasi watashi no my kisah sayang gweh titiang no waifu sudah selalu support teyvatLontar
# =============================================================================================================================================================
# ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⡠⢔⣪⠱⣍⢎⡳⣍⠞⠠⢐⡠⢶⡹⣎⢯⡝⡱⣝⢯⣝⡯⣝⣯⢳⣖⡌⢻⡭⢯⣝⢯⣝⡳⢦⡔⡈⠱⣏⠞⣥⢛⢦⠳⣌⠳⣘⠴⣡⠐⣀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
# ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⡀⢤⡚⡴⢣⡍⢶⡹⡜⢮⡱⣁⠊⣄⣣⡝⣧⢻⡜⣧⠍⣵⣏⢯⣞⣭⡽⣎⡿⣜⣳⣆⠹⣧⣛⡾⣼⡹⣝⡺⣵⢆⠈⢟⡴⣋⢎⡳⣌⢳⣉⠖⡤⢓⡌⢦⠀⠀⠀⠀⠀⠀⠀⠀⠀⠡⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
# ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⢠⡐⢎⡙⢦⡹⣔⢣⢞⣣⢳⢭⡳⢑⠠⣜⡖⣧⣛⢮⣯⣝⠮⢼⣳⣭⡟⣞⣧⢿⣹⣝⢾⣳⡽⣧⠘⣧⡟⣵⣛⢷⣹⢎⣯⢳⡄⠳⣙⡎⢷⣌⡳⢬⣙⢲⠣⡜⢢⠓⡄⠀⠒⠀⠀⠈⠀⠀⠀⠆⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
# ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⡀⢤⠒⡍⢦⡙⣬⡙⢦⠳⣎⢏⠾⣌⣟⡲⠍⣂⢳⢮⡝⡶⢯⣛⣶⢫⢃⣿⣳⡽⡞⣽⡞⣯⢷⣫⢯⣷⢻⣽⣳⡈⣿⢳⣯⢻⡞⣯⠞⣧⢻⣥⡘⢼⠳⣌⡳⢣⢎⠧⣣⠹⢥⠋⡜⢢⠀⠀⠀⠀⠀⠀⠀⡁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
# ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⡤⣐⢣⡙⢆⡛⣌⠳⡜⢦⡝⣣⠟⣜⢮⡻⣜⢶⡙⢤⡹⣏⡾⣝⢿⣯⢽⣞⡏⣼⣳⢯⣟⡧⣿⡽⣯⢿⣝⡿⣞⣟⣾⣳⢷⡜⣟⡾⣯⡽⣞⡿⣼⢳⣎⢷⣂⠻⣜⡱⣏⢎⡳⢥⡛⣬⠓⡌⢓⢆⠁⠀⠀⠀⠀⠀⠄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
# ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⠞⡰⠡⢦⡙⡎⡵⢊⠷⣙⢦⣛⡥⢿⡜⣧⣻⡜⡧⢈⡾⣵⢯⡷⣯⢷⣾⣻⢾⡁⣿⡽⣯⢾⡇⣷⡿⣽⢾⡽⣯⣟⡾⣾⡽⣯⢿⣹⢷⣏⡷⣯⢗⣯⣗⢮⡷⣭⢧⡸⡱⢎⡧⡝⣦⣙⢦⡛⡜⡄⠊⣆⠡⠀⠀⢀⠘⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
# ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣠⢋⠜⡡⢓⠦⡱⣍⢖⣫⢳⡝⣮⢵⣫⢷⡹⣖⣧⡻⢀⡿⣽⣫⡾⣽⣞⡿⣞⣷⣻⢰⣟⣾⡽⣯⣗⣹⢯⣟⣯⣟⡷⣯⣟⣷⣻⡽⣯⢷⣻⢾⣝⣷⡻⣾⢼⣣⡟⣼⢣⡗⡜⣭⡚⡵⢦⡙⣦⢳⡉⡖⡁⠐⢂⠡⢀⠀⠤⢀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
# ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⡰⢂⠩⢠⡑⢮⡱⢳⡜⣪⢖⣻⣼⢣⣟⡼⣳⢻⡼⣳⠁⣾⣽⣳⢯⣟⣷⣛⣾⣟⡾⡇⢸⢯⣷⣻⣟⣾⢸⣯⣟⣾⢯⣟⣷⣻⣞⣷⣻⡽⣯⣟⡽⣾⣱⢿⡭⣷⢫⣟⡼⣛⡼⣹⡔⣯⣙⢮⡱⢎⢧⢳⡌⠵⡀⠌⠂⢀⠂⠀⠀⢆⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
# ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⡐⢁⠂⡡⢂⡝⢦⣙⢣⢞⡱⣯⢳⣎⡿⢮⡽⢯⣟⡼⡇⣼⣻⢾⣽⣻⣞⣷⣻⢾⣽⣻⡇⣺⣟⣾⣳⢿⣽⢸⣯⢿⣞⣿⢾⣯⢷⣻⣞⣷⣻⢷⢯⣟⡷⣯⢷⣻⢞⡟⣾⡹⡵⣋⢧⡻⡔⣏⠶⣩⣛⣬⠳⣎⡱⢱⠀⠂⠄⡈⠄⠀⠀⠆⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⠀
# ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠐⢀⠢⠘⢄⠣⢎⠳⣬⢓⢮⡱⢯⡳⢾⡽⣯⣟⡿⢾⣽⢠⡿⣽⣻⣞⣷⣻⢾⣽⣻⢾⣽⡇⣹⣾⢷⣻⣿⣽⡎⣿⢯⡿⣾⣟⡾⣯⣷⣻⢾⡽⣯⣟⡾⣽⢯⣟⡷⣯⢟⣷⣫⢗⡸⢧⡻⣝⢮⡹⣇⠾⡴⢻⡴⣙⠦⣃⠈⡐⠠⠈⠄⠀⠡⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
# ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⢄⠢⡉⢆⡹⢌⡳⣌⢏⠶⣹⢇⢯⣟⡿⣷⣯⣟⣯⠆⣼⣻⢷⣯⢾⡷⣯⢿⡞⣱⣯⡿⠀⢹⣾⣯⡷⣿⣞⡇⣿⣻⣽⡿⣞⣿⣳⢯⣟⣯⣟⡷⣯⡿⣽⡟⢾⣽⣻⣞⣧⣟⢾⣡⠳⡽⣎⢖⢣⢽⡻⣜⡳⢦⡙⢦⡑⠆⠠⠁⠌⠠⠀⢀⢁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
# ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠠⢉⠄⢢⠑⢢⠑⣬⠳⡜⣎⠳⣍⠞⣼⢫⡽⣯⡿⣽⣺⢡⣯⠿⣽⣞⣯⡿⣽⡟⢱⢿⡽⠁⡄⢻⣽⣾⡽⣟⣾⣧⢹⡿⣽⣻⣽⡾⣯⣿⢾⣻⡾⣽⣳⣿⣻⣿⠀⠙⠷⣞⣧⢿⣧⠳⡌⢳⢯⡜⡔⢎⡷⢭⡺⢄⡳⢨⠜⣡⠀⠡⠈⠄⠐⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
# ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠌⡐⡈⠜⡠⢉⠢⣙⢦⡛⠼⣌⠳⣎⠝⣮⠳⣽⣻⣽⡧⡗⣸⣽⢻⣽⡞⣷⣟⡿⢀⣿⠟⠀⣴⡁⢸⢷⣻⢿⣽⣳⢿⡘⣿⣽⣯⣟⡿⣷⣻⢿⣳⣟⡿⣽⣷⣻⡿⠀⠀⠀⠈⠻⡾⣽⡇⣳⠈⣞⡇⡇⢮⢹⢣⡑⢣⠜⡀⢇⠲⠌⠠⠁⠌⠀⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
# ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⡐⠠⠐⡡⢊⠔⡁⠆⡝⢦⢋⡳⣌⠳⡼⢸⣒⠯⣖⢯⣻⢗⡇⡟⣾⣿⣾⣻⣷⡻⠀⣾⠋⢀⡼⣰⠃⠀⣯⢿⣿⣾⢿⣯⠇⢻⣽⣾⣟⡿⣷⢿⣯⢿⣯⢿⣽⢾⡟⠀⠀⠀⠀⠀⠀⠈⠺⣷⠱⡂⠱⣻⡜⢠⡛⡴⢩⢃⠎⡥⠘⡌⢣⠀⠡⠈⠄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
# ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⠂⠄⡁⢎⠰⠁⠰⡈⢼⣩⠇⡎⡵⣊⡗⡃⣼⢪⢗⣮⢳⡝⡾⢀⡿⣿⣿⣿⣟⡕⠀⡜⠁⢠⠞⡴⣡⡗⠀⢹⠎⣿⣿⡿⣯⢷⠘⣿⣷⣿⣿⣿⣿⣾⣿⣿⣿⣿⡟⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⢷⣡⠀⢳⣝⡂⠵⣱⢋⡬⢓⠴⠀⠸⢡⠀⠡⢈⠐⡀⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
# ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⠐⢀⠐⠠⢌⠂⠀⠌⠤⡑⣞⠆⡸⢔⣣⢳⡜⡃⢼⣹⢺⡴⣏⢾⡹⢨⡽⣿⡻⣝⡞⢀⠨⠀⣰⢫⢞⣴⣿⣷⠀⠘⣯⠜⣿⣽⣿⢾⡄⣛⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢻⡀⠌⣞⡅⢫⡔⣣⢜⡡⠚⣀⠴⡣⠌⡁⠂⠐⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
# ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠄⠂⢀⠂⠌⡰⠈⠀⢌⠨⡐⡹⢌⠒⡸⢌⠶⣩⢞⠁⣎⢧⣏⠶⣝⢮⡇⢸⡜⣧⢻⡕⠀⠎⢀⢞⡅⣣⣿⣿⣿⣽⡇⠀⢩⡻⣌⡻⢽⡧⣇⠸⡼⣿⣹⡟⢿⣿⣿⣿⣿⣿⡄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⣧⠴⠘⠶⠰⠵⠎⠦⠑⠊⠉⠀⠆⡁⠄⠡⠐⠠⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
# ⠀⠀⠀⠀⠀⠀⠀⠀⢀⠂⠀⠀⠂⠌⠠⠁⠠⠈⢄⠡⢂⡝⠠⢃⡝⣊⠷⣩⠞⠀⣎⢷⢪⡟⡽⣎⠇⣸⡜⣧⠏⡀⠉⣰⠙⣢⣾⣿⣿⠷⣿⣿⣿⡀⠈⣷⡹⢞⣧⢻⡽⠄⢓⣭⠷⠞⠋⠀⠀⠈⠉⠛⠳⣄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⡸⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢰⠃⡁⠌⡐⠀⠁⠄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
# ⠀⠀⠀⠀⠀⠀⢀⠈⢀⠀⠀⠠⠁⠌⠀⠠⢁⠡⢈⠢⡑⢨⠐⢱⢪⠵⣙⠦⡛⠀⡞⢮⡳⣝⡳⣽⠂⣳⡽⠊⠐⠀⢊⣁⣈⣭⣤⣤⣤⣤⣤⣤⣀⣉⠀⠐⠯⣛⣦⢝⠯⣛⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠑⣀⠀⠀⠀⢇⠀⠀⠀⠠⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢠⠃⠰⠈⠄⡁⠀⢈⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
# ⠀⠀⠀⠀⢀⠐⠀⡀⠂⠀⠀⢂⠁⠀⠠⠁⠂⠄⢃⠢⢑⠂⠜⣨⢓⢎⡵⣩⠁⠀⢽⣊⢷⡩⢷⣉⡅⠴⠂⢀⣠⣾⣿⣿⣿⣿⣿⣿⣿⣿⣿⢿⣿⣿⣧⠀⠱⣦⢹⣎⢷⣪⡓⣤⡀⠀⠀⠀⠀⠀⠀⠀⡀⢀⠀⠈⠣⡀⠀⣾⣧⡕⣠⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠇⠀⡀⢁⢂⠐⠀⠀⢀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
# ⠀⠀⠀⡀⠂⢀⠂⠀⠀⠀⠈⠀⠀⡀⠂⠀⠌⠰⡈⠔⡡⠊⠄⡣⢏⡲⡜⠁⡀⠀⢸⢬⡳⡅⡻⣜⠃⠀⣴⣿⣻⣿⢿⣿⣷⣿⣿⣽⣿⣯⣿⣿⣿⣻⣾⡆⠀⠹⢶⡹⣞⡲⡅⠈⢷⠀⠀⠀⠀⠀⠀⠀⠀⢀⣤⡴⣦⣙⡏⡿⠱⣷⠋⣀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣘⠃⢀⠐⠈⠄⣈⠀⠐⠀⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
# ⠀⠀⡐⠀⠐⠀⠀⠀⠀⠀⠀⠀⡐⠀⠀⠌⠠⢑⠠⢃⠤⢁⢢⠳⣍⢲⠁⢒⠀⠐⠈⣣⠳⡅⢱⡹⡅⢾⣿⣷⣿⣻⣿⣯⣿⣯⣿⣿⠿⢿⢛⡛⢯⣿⣯⣷⡄⠂⠉⠗⠁⡁⣀⠂⠘⡦⠀⠀⠀⠀⠀⠀⠈⠠⠉⠿⢯⣿⣿⡠⣁⠂⢲⣦⢶⠊⠀⠀⠀⠀⠀⠀⠀⢀⡴⠃⠀⠄⡈⠄⠡⢠⠀⠀⢂⠠⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
# ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⠂⠀⠀⡐⢈⠐⠨⢄⠃⠀⠄⢸⠱⢎⠃⡈⠔⠂⠈⠄⢱⠛⡄⠐⠻⠄⠻⠿⣾⣽⣿⣻⣿⣿⣭⣷⣤⣬⣽⠶⣤⣅⡙⢿⣽⣿⡀⠄⢂⠡⠐⣀⠢⠀⡘⣇⠀⠀⠀⠀⠀⠀⠀⣀⢤⠼⣿⣾⣇⣤⣅⡹⠏⠃⠀⢀⢀⡀⠄⣤⠶⠚⠋⠀⠀⠌⠐⡀⢂⠱⡀⠠⠐⠀⡀⠂⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
# ⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⠂⠀⠀⠠⠐⠠⠈⡅⠊⡐⠠⠘⢠⡛⡜⠠⢘⡈⠀⠀⢊⠐⡏⠖⠀⠁⠀⠀⠀⠀⠀⠀⠉⠉⠉⠉⠉⠁⠀⠀⠀⠀⠈⠙⠻⣷⣦⡹⠄⢀⠂⢡⠀⠆⡡⠐⡘⢷⣤⣀⡠⣤⡴⠚⠁⠀⠃⣿⠋⣿⠙⠿⠶⢄⡀⠈⠉⠁⠀⠀⠀⠀⠙⠶⣄⠡⢈⠐⡀⢂⠠⡁⠠⠀⠐⡀⠡⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
# ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⠡⠘⠠⢁⠌⠁⠀⢄⡉⢴⡙⠠⢁⠆⡐⠀⠀⠂⠆⡘⠼⡀⠌⡆⢠⣀⢠⠀⠀⠀⣀⣀⣠⣤⣴⣶⣾⣿⣿⣿⣿⣷⣮⣿⣿⣷⡀⠈⠠⠘⡐⠠⠂⢱⡀⠆⠠⣱⠎⠀⠀⠀⠠⠀⠃⠀⢸⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠘⣇⠠⢀⠐⡀⢒⠀⠡⠀⠐⢀⠡⠐⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
# ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠄⢂⠁⠒⡈⠄⠀⠌⡠⠄⣣⠃⠰⢈⠰⠁⠀⠀⠈⡔⠠⠱⣁⠂⡐⠘⣿⣫⣴⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣷⣿⣻⣿⣾⣟⣷⡠⠀⠣⣀⡑⢈⠀⢲⠀⢸⡇⠀⠀⠀⠀⠀⠐⠀⠁⠈⢧⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢸⠀⢀⠂⢌⠰⠈⠐⠀⠀⠂⡐⢀⠂⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
# ⠀⠀⠀⠀⠀⠀⠀⠁⠀⠀⠀⠠⠈⠄⡈⠡⠀⠀⠌⡐⡀⠆⡑⠠⡑⡈⠆⠁⢀⠂⠀⠄⢃⠔⠠⡐⢄⠂⢿⣿⡿⣿⣿⣽⣿⣿⣿⣿⣿⣿⣿⣿⣿⣯⣷⡿⣯⣷⣿⡿⣷⡑⡄⠈⠹⣣⡀⠀⢣⠘⡇⠀⠀⠀⠀⠀⠀⠂⠀⠀⠈⢳⣄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢸⠀⠠⠌⡀⢎⠀⢡⠀⠀⠡⠐⡀⠂⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
# ⠀⠀⠀⠀⠀⠠⠁⠀⠀⠀⠀⡐⢁⢂⠐⠁⠀⢐⠠⡁⠄⢃⠠⢁⠔⠡⠌⠀⠄⠊⡰⠈⠄⡘⢄⠢⠌⡐⠸⣟⣿⣟⣿⣿⣻⣿⣿⣿⣿⣿⣿⣟⣯⣿⣟⣿⣟⣿⡞⣱⠝⢿⡔⢦⠀⡀⢀⠂⠄⢣⠐⡔⠠⡀⠀⠀⠀⠀⠀⠀⠀⠀⢹⢳⢦⣤⣤⠄⡀⡀⡀⠀⠀⠀⠀⡼⠀⡐⡈⠔⡀⠈⡄⠀⠀⠀⠂⠄⡁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
# ⠀⠀⠀⠀⠠⠁⠀⠀⠀⠀⠐⡀⠢⠀⠀⠀⡐⠠⢂⢁⠊⡄⠃⢌⢂⠑⠂⢈⠀⡰⡍⣇⠐⢈⡐⠢⢑⠨⢀⢻⡿⣿⣿⢿⣿⣿⡿⣿⣿⢿⣿⣿⣿⣻⣿⢯⣿⡟⣬⢳⡻⡌⣿⠈⢳⣀⠠⠈⡐⠀⠣⠈⢆⠀⢆⠀⠀⠀⠀⠀⠀⠀⢸⡃⠀⠀⠀⠀⠀⠀⠉⠙⢧⡀⠀⡇⠐⢠⠘⡰⠀⢂⠄⠀⠀⠠⢁⠂⠄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
# ⠀⠀⠀⠀⠐⠀⠀⠀⠀⠀⡐⠀⠀⠀⠀⠐⡀⢃⡐⢂⠡⠄⣁⠊⢄⠊⠀⢀⠎⢄⠹⣜⣃⠀⠰⢁⠊⡔⡁⠄⢹⣿⣿⣿⣿⣟⣿⣿⣿⣿⣿⡿⣿⣿⣾⡿⣿⡜⣧⡟⣵⡃⡞⢸⣆⢭⢓⡄⠠⠁⠄⠱⡄⠀⡜⠀⠀⠀⠀⠀⢀⣴⠏⢆⠀⠀⠀⣤⣀⣠⣖⠀⠠⠉⣀⢃⠨⠄⢃⠔⠀⡂⠀⠀⠀⠀⠠⠈⠄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
# ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠐⡈⢄⠰⠈⡔⠂⠀⠌⢂⠁⠠⣏⠐⢪⠄⡯⣜⢣⡀⠊⠔⡰⢈⠄⢂⠹⣿⣻⣿⣿⣿⣿⣿⣿⣟⣿⣿⣿⣿⣽⣿⣿⣼⢝⡶⣽⠇⣿⡿⣧⡘⢼⡱⣄⠈⠄⢈⠞⠀⠀⢀⣀⠤⠞⠉⠀⡰⠀⠈⠁⢀⡴⠃⣴⠈⠁⠀⠀⠀⠀⢣⠈⠂⠀⠠⠁⠀⠀⡠⠂⠠⢁⠂⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
# ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⡐⠈⡄⠃⠤⠁⠀⢩⠐⠀⢲⠌⠓⢄⣂⠳⠼⣩⠝⣦⡈⠐⡌⢌⠂⠤⠘⢿⣿⣿⣿⣿⣿⣾⣿⣿⣿⢿⣯⣷⣿⡾⣿⣷⡿⣿⣴⣿⣿⣟⡿⢆⡳⣌⢳⣂⡊⠂⠙⢯⡛⡴⣢⢌⡓⢌⠀⠀⠀⠀⠉⠈⠀⠋⠀⠈⢢⣀⡀⠠⠤⠥⠁⠀⡐⢀⠰⠁⠀⠒⠅⡂⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
# ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠠⠁⠤⢉⠰⢁⠀⠀⠎⠀⠈⠩⠳⡤⣀⣒⡐⡁⢟⢦⡹⣒⣄⠂⠩⡐⠌⡀⠙⢿⣿⣿⣿⣿⣿⣿⣿⣿⡿⣿⣻⣽⣿⣻⣽⣿⣻⣾⣟⡾⣟⣭⣶⣭⣖⡙⢿⣶⣤⣀⠙⠳⣮⡽⣝⡶⣍⠒⠂⠐⢨⠁⠀⠀⠀⠀⡜⠀⠀⡀⠰⠀⠀⢀⠔⠀⠀⠀⠀⠀⠀⠈⠑⠄⢀⡀⢀⡀⠀⠀⠀⠀⠀⠀
# ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠡⢈⠂⢌⢂⠀⢀⠈⠀⠀⠀⠈⠘⢣⢮⣕⢫⢎⠲⣹⢱⢎⡽⣒⡤⢌⣐⠡⠀⡉⠻⢿⣿⣿⣿⡿⣿⣿⣿⣿⣿⢾⣟⣯⣿⣻⢷⣟⣿⣽⣳⣟⡾⣽⣳⢦⣑⢯⣟⣻⢶⣬⢛⠾⡝⠋⡀⠔⠀⡀⠑⠢⣄⢀⠜⠀⡠⠄⠄⠀⠀⢠⠈⠀⠀⠀⠀⠀⠀⠀⠀⠀⠎⠀⠀⠀⠀⠈⠐⠀⠀⠀⠀
# ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢂⠡⠊⢄⠂⠀⠀⠀⠀⠀⠂⠄⡀⢀⠈⠉⠈⡀⠑⣏⢮⡱⢇⡞⣥⡙⢿⣿⣶⣶⣦⣬⣽⣿⣿⣿⣿⣻⣽⣿⡿⣿⣻⣷⡿⣿⣻⣾⣻⡷⣯⢿⣳⣟⣯⣟⡾⣽⣫⡟⠞⠋⡁⢄⠒⠌⠀⡐⠀⠡⢀⠀⠋⠰⡈⠔⡨⠀⠀⠀⠇⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⠀⠀⠰⠈⠀⠀⠉⠁⠀⠀⠀
# ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠐⡡⢈⠒⡀⠁⠀⠀⠀⠀⢂⠐⠠⠈⠄⠡⠐⡀⠈⠶⣙⣎⠾⡴⣙⡎⡻⣿⣿⣿⣿⣿⣿⣿⣷⡿⣿⡛⢋⠭⠥⡽⣬⡭⠍⠳⢟⣷⣻⣽⣯⢷⣻⣞⣾⠝⠃⠁⢀⠠⠐⡄⠢⠁⠀⢂⠠⠈⠀⠄⡌⠢⢑⡈⠒⢀⠔⠈⠈⠙⢦⠀⠀⠀⠀⠀⠀⠀⠈⠀⠀⠀⠆⠀⠈⠀⠀⠀⠀⠀⠀
# ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠐⢈⠔⠡⠀⠀⠀⠀⠀⠄⠂⠁⠌⠠⠁⠌⡐⢀⠐⡙⣬⣓⠱⣍⡞⣱⢪⡙⢾⣿⡿⣿⣾⣿⣿⣻⣿⣯⡿⣽⣳⢿⣼⣳⡷⣞⣯⣷⣻⢾⣟⠷⠋⠀⢀⠠⠌⠐⠈⠁⠀⠠⠀⡁⠀⠀⠄⡑⢨⠐⡈⡖⠤⠖⠁⠀⠀⠀⠀⠀⠙⠀⠀⠀⠀⡀⠀⠀⠀⢀⠀⠦⠤⡀⠀⠀⠀⠀⠀⠀
# ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⢆⠡⠀⠀⠀⠀⠐⠈⠠⢈⠠⢁⠂⡐⢈⠀⠐⠘⢿⣿⣶⣬⣥⣃⣋⣱⣨⣻⣿⣿⣻⣟⣯⣿⢷⣟⡿⣽⣻⢷⣯⢿⡽⣾⣽⢯⠟⠁⠀⠀⠀⣀⣀⠤⠤⢤⢒⠂⠀⠐⠀⠠⠡⢘⠐⠄⠃⣀⠃⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠸⣠⠃⠀⠀⠠⠀⠀⠀⠀⢐⠀⠀⠀⠀⠀⠀
# ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠊⠄⡀⠀⠀⠈⡀⢁⠀⠂⠄⠂⠄⠂⠀⠐⡀⠘⢿⡾⣟⡿⣿⢿⡿⣿⢿⣿⣻⣽⡿⣿⣻⣿⢿⡿⣽⣟⡿⣾⢿⡽⣿⡾⠃⠀⣠⣴⢾⡿⢋⠅⢮⡱⠂⠀⠠⠁⣀⠂⡁⠆⡱⠈⠀⠀⠀⡇⠀⠀⠀⠀⠀⠀⠀⠒⠒⠶⣞⢦⠱⠂⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
# ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⠀⠀⠀⠠⠐⠀⡈⠐⢀⠁⢠⠁⠀⠰⢡⠀⡄⠈⠿⣟⣿⡿⣿⣿⡿⣿⢿⣽⡿⣟⣷⣿⡿⣿⣳⣿⣽⣯⣿⣟⡯⢁⡴⣟⣯⣟⡏⠱⡬⠙⠆⠁⡄⠃⠁⡐⢀⠂⡁⢂⠁⠀⠀⠀⠀⠘⠄⣠⠤⠂⠀⠀⠀⠀⢀⣠⢤⣀⠀⢁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
# ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠐⠠⠀⠅⠀⢐⠂⠀⠀⠢⢡⠀⢘⡱⢂⡙⠻⣽⡷⣿⡿⣿⣿⢯⣿⣟⣿⣾⣟⣷⣟⣾⣳⢯⣷⡟⣰⣯⢿⡽⣞⠎⡌⡓⠁⢡⢈⡒⠀⡐⠐⡈⠄⠒⠀⡜⠀⠀⠀⠀⠀⢀⠇⢠⠃⠀⠀⠀⠀⠀⠁⠀⠀⢀⡄⢄⠀⢀⢀⠀⠠⢀⡀⠀⡁⠀⠀⠀⠀⠀
# ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠁⠌⠀⠠⢃⠠⠀⠠⠁⠆⠂⢈⢖⡡⢊⠥⣈⠙⢯⣿⣻⣽⣿⣯⣿⣾⡽⣾⡽⣯⢷⣯⢿⣽⣻⢷⣯⠿⢉⡴⠑⢀⠰⠘⠂⠁⠀⠂⠀⠁⠀⡠⢄⠡⠃⠀⠀⠀⠀⠀⡘⠀⡜⠀⠀⠀⠀⠀⠀⠀⠀⠀⡈⡀⠀⠀⠄⠂⠀⠀⠀⠌⠐⠀⠀⠀⠀⠀⠀
# ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⡀⠀⠀⠀⠀⠃⢂⠀⠀⠄⡑⡈⢡⠈⢎⡖⡌⠒⡥⢋⡔⡈⠻⠷⣿⣽⣷⣻⣽⣻⣽⣻⣟⡾⢯⣷⣻⡟⢊⠄⠋⡠⠄⢀⠠⡀⢆⠀⠠⠁⠐⢀⠂⠑⢄⡀⠀⠀⠀⠀⢀⠞⠀⢠⠁⠀⠀⠀⠀⠀⠀⠀⠀⢠⢁⠀⠁⠀⠀⠀⠀⢀⠌⠀⠀⠀⠀⠀⠀⠀⠀
# ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠂⠄⡁⠂⡄⣀⠀⠀⠀⠀⠒⠠⠘⡀⠀⠞⡴⣓⡘⠤⢣⡘⢬⠑⣂⠅⠻⢾⣟⣯⢿⣳⣟⡾⣽⣯⢷⠭⠂⠠⢌⢒⡱⠂⡐⢂⢁⠂⠀⠄⠀⠌⠀⠠⠀⠀⡆⢡⠀⠀⠊⠁⠀⠠⠂⠒⠒⠒⠂⠠⠤⠄⠒⠉⠀⠒⠄⣀⠀⡔⠉⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
# ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⡀⠂⠀⠀⠀⠀⠀⠠⠁⠂⢄⠱⡀⠆⠈⠀⠀⠠⠐⡀⢂⠐⠀⡻⢔⣣⠳⡌⢥⠚⡤⢋⡔⢪⠱⡠⠌⠛⠻⠷⠯⠿⠟⠊⡁⡔⢪⡑⢪⠰⡘⡅⠀⠂⠄⠂⢀⠀⠌⠀⠂⢀⡤⠞⠁⠀⢣⠈⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
# ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⡀⠐⠀⠀⠀⠀⠀⠀⠂⠀⢀⠔⡉⢄⠒⡈⠀⠀⠀⠠⢁⠂⡐⠠⠈⠄⢘⡣⢎⡳⣙⢆⡳⡘⢦⡘⣡⠣⡑⢎⡱⢢⡐⢢⠔⣂⠧⠱⡘⢢⡘⠤⢃⡝⠀⠠⠁⠌⠀⠀⠀⢀⠴⠊⠁⠀⠀⠀⠀⠈⡆⠁⠀⠀⠀⠀⣀⡤⣶⢺⡟⣽⢫⡗⣶⡤⣄⣀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
# ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⡀⠄⠂⠁⠀⠀⠀⠀⠀⠀⠀⠀⡠⠌⡂⠔⡈⠆⠈⡀⠀⠀⠠⢁⠀⠂⠄⡁⠌⡀⠈⣇⢏⠶⣩⢎⡴⡙⢦⠸⣄⢣⡉⢦⠘⡤⡑⢣⠜⡰⢌⢣⠑⡆⢱⡘⢲⡘⠆⠀⠈⢀⠈⢀⡴⠋⠀⠀⠀⠀⠀⠀⠀⠀⢸⠀⠀⢀⡴⡺⣭⣳⢭⢷⣹⢮⢷⡹⣶⡹⣎⢷⣫⢖⡤⣀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
# ⠀⠀⠀⠀⠀⠀⢀⠀⠠⠀⠐⠀⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀⡀⠔⡡⢐⢂⠱⡈⢀⠂⠐⠀⠀⠀⡐⠀⠌⠐⡀⠄⠂⡐⠀⢸⣊⠷⣱⢊⡴⠹⣌⢳⡘⢦⡑⣊⠱⣂⠝⠤⢋⡔⡉⢆⡱⢨⠡⡘⢥⢚⠀⠀⠀⠀⠀⢸⡁⠀⠀⠀⠀⠀⠀⠀⠀⠀⢨⢇⡐⢧⢳⡱⡜⣧⣛⢮⡳⣏⠾⣝⢶⢻⡜⣧⣛⢮⡳⣭⢳⡤⡀⠀⠀⠀⠀⠀⠀⠀⠀
# ⠀⠀⠀⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⡠⠐⡌⠰⠁⠆⡡⠌⠂⠐⠀⠈⠀⠀⠀⡐⠀⡈⠀⠂⠀⠄⠡⠐⠀⠀⢧⡚⣥⢫⢔⡫⡜⢦⡙⢦⡱⣉⠶⣁⠞⡨⢅⠢⢍⡒⡰⢃⠱⡩⢆⡫⠔⠒⠉⠉⠓⠪⡆⠀⠀⠀⠀⠀⠀⠀⠀⢀⡜⣦⡙⢮⡱⣚⠴⣣⢏⡷⣹⢎⡟⣮⢏⡷⣹⠖⣯⢞⡵⣋⠷⣭⣛⣤⡀⠀⠀⠀⠀⠀⠀
# ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⡀⠄⡰⠀⢃⠐⠡⢐⡈⢅⠊⠀⡀⠂⠌⠀⠀⠀⠀⠄⢀⠐⠀⠀⡁⠈⠄⠂⠡⠀⠀⠸⡑⢮⡱⢎⡱⢎⠵⣊⠇⡶⡑⢎⡴⢩⠖⣩⠹⢬⡱⢃⠢⣩⠔⠉⠀⠀⠀⠀⠀⠀⠀⠈⠀⠀⠀⡀⠀⠀⢀⠖⠉⠀⠁⠛⢦⣓⡭⣚⡽⣎⢷⡹⢮⡝⣞⢮⢳⣭⢻⡜⣮⠳⣭⣛⠶⣱⠶⣙⢦⡀⠀⠀⠀⠀
# ⠀⠄⠠⡀⠔⡠⢂⡐⢠⠐⣀⠒⡐⠢⡐⡐⠤⢁⠊⡄⠃⠆⠈⠀⡀⠢⠄⠁⠀⠀⠀⠀⡐⠀⠠⠀⠀⠁⡀⠐⠠⠁⢂⠁⠰⠀⢹⢆⡳⣍⠲⣍⢮⡱⢎⡵⡩⢎⡴⢃⡞⣡⢋⠶⠁⠠⣞⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢰⠀⠀⠠⠃⠀⠀⠀⠀⠀⠀⠉⠈⣵⢳⡝⣮⣝⡳⢞⡭⣞⡳⣬⢧⣛⡴⣛⢦⡝⣮⢇⡻⣜⠲⣍⢆⠀⠀⠀
# ⠈⡌⢁⠒⢌⡐⠤⡈⠔⡨⢄⡘⠤⠁⠆⠡⠂⠁⠊⠀⠐⠀⡀⢆⠐⠁⠀⠀⠀⠀⢀⠐⠀⠠⠀⢀⠈⠀⠄⠈⠄⠂⠄⠀⢬⠡⠈⣖⡱⢎⡳⢜⠂⡧⣋⠶⣑⢣⡜⣣⠜⣥⠈⢠⢉⢎⡤⡹⡄⠀⠀⠀⠀⠀⠀⠀⠈⢭⣛⢶⠢⠐⢠⠀⠀⠀⠀⠀⠀⠀⠀⠀⣰⢩⡞⣝⠶⡼⣙⢮⡳⣥⡛⣦⠧⣏⢶⣙⢮⡜⡶⣩⠳⣌⡻⡜⢮⡄⠀⠀
# ⠡⣈⠢⠉⠄⠒⠀⠁⠈⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠔⡠⠑⠀⠀⠀⠀⠀⠀⠠⠀⠀⠠⠀⢀⠀⠄⠈⠠⠈⡀⠌⠀⡠⠎⡱⠂⢸⡘⢧⡙⠆⠈⡵⣡⢛⠬⠳⠜⠡⠛⠐⠂⣀⠈⠄⡠⢀⠘⣦⡀⠀⠀⠀⠀⠀⠀⠂⢉⣈⣁⢈⡴⠀⠀⠀⠀⠀⠀⠀⠀⢠⢣⢞⡹⣜⣫⠵⣋⢮⢳⡜⣹⣒⢏⡞⢦⣛⢦⡙⡶⣡⢛⡴⢣⡝⢦⠳⡀⠀
# ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⡀⠀⠀⡠⢐⠉⠀⠀⠀⠀⠀⠀⠀⠀⠂⠀⠐⠀⢀⠠⠀⠠⠐⠈⢀⠐⢀⠀⠠⡡⢎⡕⡣⠐⠹⠆⠙⠁⡀⠀⠄⢂⠠⢀⠆⡡⠘⡄⠣⠄⣉⠂⠅⢨⠐⣨⠍⠃⠈⠀⠀⠀⡠⠾⢙⠞⣩⠆⠁⠀⠀⠀⠀⠀⠀⠀⢀⡎⡇⣏⠷⡹⣜⡹⢭⡚⡧⢞⡱⣎⢏⡞⡵⣚⢬⢳⡱⣙⠮⣜⢣⠎⢧⡙⢦⠀
# ⠀⠀⠀⠀⠀⡀⠄⠂⠁⠀⠈⠀⠀⠁⡀⠰⠈⠀⠀⠀⠀⠀⠀⠀⠀⠀⡀⠁⠀⠐⠀⠠⠀⢀⠠⠐⠀⡈⠀⠄⠂⣀⢞⣡⠏⠊⠁⠠⢀⠂⠌⠐⠀⢡⠐⢢⠑⠌⢂⠡⠡⠐⡁⠒⠠⠌⡈⠄⡼⠁⠀⠀⠀⠀⠀⠀⠀⢀⠄⠀⠃⠀⠀⠐⢀⡀⠀⠀⠀⣠⠞⡸⣜⢣⡟⡵⢎⡽⡲⣍⡳⢭⠳⡜⢮⣜⡱⢭⢎⢧⠳⣍⠞⣬⢣⠛⡦⣙⠦⡁
# ⠀⠀⢀⠀⠁⠀⠀⠀⠀⣀⠡⠐⠈⠁⠀⠀⠀⠀⢀⠀⠄⠐⠀⠁⠀⢀⠀⢀⠈⠀⠀⠄⠠⠀⡀⠄⠂⢀⠁⢠⡓⡭⠊⠀⠀⢂⣁⠄⡒⣖⠊⢠⠘⠀⡉⢀⠢⢈⠂⡄⢃⡘⠠⡁⢃⠤⠑⢸⠇⠀⠀⠀⠀⠀⠀⠀⢀⠎⠀⠀⠀⠀⠀⠀⠀⢹⢙⡲⢍⡳⢸⡱⣙⢮⡜⣣⢏⢶⡱⢎⡵⢫⡝⣜⡣⣎⠵⣋⢎⣎⠳⣜⠺⣤⢣⡛⢴⠱⣊⠕
# ⠀⡐⠀⠀⠂⠄⠒⠈⠁⠀⠀⠀⡀⠀⠠⠀⠂⠈⠀⠀⠀⠀⠀⢀⠠⠀⠀⡀⠠⠀⠁⠠⠀⠐⠀⠠⠈⡠⢎⡳⠈⠀⠀⠀⠀⢧⡘⣆⠙⠠⠐⢁⠠⢁⠒⡀⢂⠡⠈⢀⣀⢤⡡⡄⠀⠀⢰⡾⠀⠀⠀⠀⠀⠀⠀⢀⣾⠀⠀⠀⠀⠀⠀⠀⣠⠋⠴⡑⣎⡱⢣⡝⡼⢢⡝⢦⣋⠶⣙⢮⡱⢣⢞⣡⠳⣌⠳⣍⢎⡖⣹⢢⢛⡤⢣⡝⢢⠝⣢⡙
# ⠀⢀⠀⠁⠠⠀⠠⠀⠂⠀⠁⡀⠀⠐⠀⠠⠀⠐⠀⠀⠁⠀⠠⠀⠀⠠⠐⠀⢀⠀⢁⠠⠈⠀⠈⢠⠎⠵⠋⠀⠀⠀⠀⠁⡠⢔⡩⠖⠀⢁⠐⡈⠐⡀⠂⠐⣠⠖⣭⠳⠜⣂⣵⣺⣟⠆⢨⢽⠀⠀⢀⣀⡤⠤⢖⠫⡜⡄⠀⠀⠀⠀⠀⠴⢁⡎⡵⣉⢖⡩⢖⡹⣜⢣⠞⣣⢎⡝⣎⠶⣩⢓⡎⢶⡹⣌⠳⡜⣎⠼⣑⢎⡱⢎⡱⢎⢣⡹⢤⡙
# ⠀⡀⠌⠀⡁⠠⠁⠐⠀⠁⡀⢀⠐⠀⠈⢀⠀⠂⠀⠀⠀⠐⠀⠀⡁⠀⣠⠖⡏⠀⠀⠀⢀⡀⠀⠈⠀⠀⠤⠂⠀⢈⡠⢒⡱⣊⠒⠀⡐⢀⠂⠄⠡⣠⠀⠀⠀⢉⣤⡶⡿⢽⡚⣥⠎⠀⢰⠊⣧⠖⣙⢦⠹⡈⣇⠳⢆⡱⣄⠀⠀⠀⡆⠀⣜⡰⢃⢇⢎⠲⣍⠶⣩⢎⡝⢦⣋⠼⣌⠳⣥⠫⣜⢣⠖⡭⢓⡹⡌⠞⡥⢎⠵⢪⠕⣎⢣⠜⢦⡙
# ⠀⡀⠐⠠⠐⠀⠐⠀⣨⠾⠀⠀⠠⠈⠀⠄⢠⠐⠂⠁⠀⠂⠈⠀⣠⠞⠁⠀⣇⢀⣀⠰⠋⠀⢀⡠⠂⡜⠀⢠⢂⠳⣌⠣⢖⠀⢀⠐⡀⠂⢌⡔⡳⠀⠀⠀⣰⡟⡯⣝⡞⠥⣛⠀⠀⠀⢈⠷⡱⠎⣑⣮⣻⠘⡴⣋⡜⢦⡌⣢⢄⡀⠐⡀⢣⢚⡍⡎⢎⡱⢎⡳⡱⢎⡜⣣⢎⡳⣌⢳⣌⢳⣌⠳⣎⡱⢫⠴⣩⢛⡜⣬⡙⣎⠞⣌⢣⠛⠂⠀
# =============================================================================================================================================================